
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>antonym.org</title>
  <meta name="author" content="Gavin Baker">

  
  <meta name="description" content="The humble for loop is one of the oldest control flow control constructs
in the Algol-family of languages. Yet while other languages have extended &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://antonym.org//index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="antonym.org" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!-- before custom head -->
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
<a href="https://twitter.com/gavinb" rel="me">Twitter</a>
<link rel="openid.server" href="https://indieauth.com/openid" />
<link rel="openid.delegate" href="http://gavinb.antonym.org/" />

  <!-- after custom head -->
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6131956-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><h1>antonym.org</h1>
<h2>Bits by Gavin Baker</h2>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:antonym.org/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2014/02/c-plus-plus-11-range-based-for-loops.html">C++11 Range-based for Loops</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-02-25T08:44:00+11:00" pubdate data-updated="true">2014-02-25</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The humble <code>for</code> loop is one of the oldest control flow control constructs
in the Algol-family of languages.  Yet while other languages have extended
their syntax to allow <code>for</code> loops to do all sorts of crazy and useful things
beyond iterate over a range of numbers, C and C++ have remained steadfast &ndash;
until now.</p>

<p>The <code>for</code> loop finally has a new syntax to better support iterators and
ranges (a great new feature in C++11/14).  So you can now iterate over much
more than just numbers.</p>

<p>The C++ container classes provide iterators, but the looping syntax is
rather unweildly but familiar pattern:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iter</span> <span class="n">it</span><span class="p">;</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="n">it</span> <span class="o">=</span> <span class="n">vec</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">vec</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span><span class="o">&amp;</span> <span class="n">n</span> <span class="o">=</span> <span class="o">*</span><span class="n">it</span><span class="p">;</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">+=</span> <span class="n">n</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>For some time, the most excellent <a href="http://www.boost.org/">Boost++ project</a>
has provided some syntactic sugar to reduce the complexity of this code
considerably.  By using Boost&rsquo;s <code>foreach</code> library, you can replace the above
loop with the much simpler:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">num</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">+=</span> <span class="n">n</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But now the C++11 specification has this style of syntax (with a slight
change of punctuation; it uses &lsquo;:&rsquo; rather than &lsquo;,&rsquo;). So now you can write:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">n</span> <span class="o">:</span> <span class="n">vec</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">+=</span> <span class="n">n</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is obviously much cleaner and clearer than the iterator-based code.  If
all you need to do is iterate over a container, you can start using this
syntax straight away.</p>

<p>(Aside: if you are actually going to sum the contents of a vector, using the
<code>reduce</code> algorithm is even better.)</p>

<h2>Ranges</h2>

<p>The iterators in the STL have <code>begin()</code> and <code>end()</code> methods to control
iteration loops.  New in C++11 are <code>begin()</code> and <code>end()</code> <em>functions</em>, which
can be used to construct ranges.  So what is a range?</p>

<h2>The new <code>for</code> loop in detail</h2>

<p>So how does this new <code>for</code> loop actually work?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2014/02/c-plus-plus-11-futures.html">C++11 Futures</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-02-25T08:44:00+11:00" pubdate data-updated="true">2014-02-25</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Concurrency is one of the most significant challenges facing software
development today.  As the gains in processor performance diminish year over
year, additional cores have become the norm.  For some years now, multicore
processors have become the norm.</p>

<p>Taking advantage of multiple cores has usually required writing multithreaded
code, which can be complex to design and debug.  One of my favourite new
features in the C++11 standard library is the <code>future</code> module.  This provides
an extra layer of abstraction over threads, providing a simple mechanism
for asynchronous (ie. concurrent) processing.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2014/02/c-plus-plus-11-futures.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2014/02/c-plus-plus-11-shared-pointer.html">C++11 Smart Pointers: Shared Pointer</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-02-13T18:45:00+11:00" pubdate data-updated="true">2014-02-13</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In the last article on smart pointers, we looked at <code>std::unique_ptr</code>, which
provides a simple and safe smart pointer to wrap heap allocations.  As the name
implies, this smart pointer type cannot be shared between multiple threads.</p>

<p>So then how can you ensure that the memory is freed once all referring threads
have finished with the resource?  This is especially difficult when the thread
lifecycle is non-deterministic.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2014/02/c-plus-plus-11-shared-pointer.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2014/01/c-plus-plus-11-unique-pointer.html">C++11 Smart Pointers: Unique Pointer</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-01-31T18:29:00+11:00" pubdate data-updated="true">2014-01-31</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>C++11 introduces many significant improvements to the language and runtime. One
of the most important is to do with memory management &ndash; specifically, smart
pointers.  The <code>unique_ptr</code> makes managing dynamically allocated memory safe and
simple.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2014/01/c-plus-plus-11-unique-pointer.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2013/10/what-is-rust.html">What Is Rust?</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-10-08T20:50:00+11:00" pubdate data-updated="true">2013-10-08</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.rust-lang.org/">Rust</a> is a compiled, hybrid imperative/object-
oriented/functional language. It appeals directly to any C++ developer who has
battled with memory management, and Python developers who long for faster code.
So why might you be interested in learning Rust?</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2013/10/what-is-rust.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2012/02/threading-with-boost---part-iii-mutexes.html">Threading With Boost - Part III: Mutexes</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2012-02-20T00:00:00+11:00" pubdate data-updated="true">2012-02-20</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="/2009/05/threading-with-boost---part-i-creating-threads.html">Part I</a> of this series on <a href="http://boost.org/">Boost</a> threading, we looked at the basics of how to create and run threads using the Boost libraries.  Then we reviewed the main issues encountered with multithreading code in <a href="/2010/01/threading-with-boost---part-ii-threading-challenges.html">Part II: Threading Challenges</a>. One of the biggest challenges is safely managing concurrent access to a resource.  A Mutex provides a way to serialise access to a shared resource, such that only one thread is accessing the data at any given time, to ensure your data is consistent.  In this article, we look at how to create and use Boost mutexes.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2012/02/threading-with-boost---part-iii-mutexes.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/12/bug-of-the-year-2011.html">Bug of the Year - 2011</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-12-24T18:24:00+11:00" pubdate data-updated="true">2011-12-24</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My favourite bug of all time was uncovered because I was just too impatient.</p>

<p>I was working on a fairly large and complex embedded project.  A microcontroller
was interfacing with some custom hardware. It would configure, control, and
monitor the hardware.  The microprocessor was running an RTOS with a lightweight
TCP/IP stack, so remote clients could connect to the device via Ethernet and
perform remote configuration.  We also used this for diagnostics and testing
during development.  We had successfully used a similar design on several
products, with great results.  We had also designed a protocol for monitoring
and control that was used in earlier models,  and  we extended it here &ndash; though
this product was significantly larger and more complex than its predecessors.
What could possibly go wrong?</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2011/12/bug-of-the-year-2011.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/03/good-code-gardening.html">Good Code Gardening</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-03-09T12:09:00+11:00" pubdate data-updated="true">2011-03-09</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>During a code review at work recently, we had an interesting discussion about code maintenance.  You could say that coding is a bit like gardening: while you are planting new seedlings, do you weed nearby areas as you go, or save up all the weeding for the next sunny weekend?  Should code maintenance be a continual, gradual process, or does it warrant being scheduled as a task in its own right?</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2011/03/good-code-gardening.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2010/04/25-tips-for-intermediate-mercurial-users.html">25 Tips for Intermediate Mercurial Users</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2010-04-07T23:58:00+10:00" pubdate data-updated="true">2010-04-07</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I recently read an interesting article by Andy Jeffries entitled <a href="http://andyjeffries.co.uk/articles/25-tips-for-intermediate-git-users">25 Tips for Intermediate Git Users</a> (linked to via <a href="http://www.reddit.com/r/programming/">proggit</a>) .  It had lots of useful information condensed into bite-sized task-oriented chunks.</p>

<p>I&rsquo;ve been using <a href="http://mercurial.selenic.com/">Mercurial</a> for a while now, so I thought I would write a similar set of tips by translating from <code>git</code> to the equivalent <code>hg</code> commands.  Thanks to Andy for blessing this translation work.  There may well be some mistakes herein &ndash; please leave a comment if you have any improvements or fixes to suggest.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/25-tips-for-intermediate-mercurial-users.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2010/01/threading-with-boost---part-ii-threading-challenges.html">Threading With Boost - Part II: Threading Challenges</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2010-01-01T21:15:00+11:00" pubdate data-updated="true">2010-01-01</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="http://antonym.org/">Part I</a> of this series on <a href="http://boost.org/">Boost</a>, we looked at the basics of how to create and run threads using the Boost libraries.  But once you have more than one thread running in a process, you have to deal with the problems and challenges that threads can introduce.  So, before delving into the mechanics of how to use mutexes and other threading constructs, we look at what can go wrong &ndash; and how to avoid it.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/01/threading-with-boost---part-ii-threading-challenges.html">Read more &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/c-plus-plus-11-range-based-for-loops.html">C++11 Range-based for loops</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/c-plus-plus-11-futures.html">C++11 Futures</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/c-plus-plus-11-shared-pointer.html">C++11 Smart Pointers: Shared Pointer</a>
      </li>
    
      <li class="post">
        <a href="/2014/01/c-plus-plus-11-unique-pointer.html">C++11 Smart Pointers: Unique Pointer</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/what-is-rust.html">What is Rust?</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Gavin Baker <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'antonym';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
